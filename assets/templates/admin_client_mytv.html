{{ template "header" . }}
{{ template "admin_header" . }}

<main class="lyear-layout-content">
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-12">
                <div class="card">
                    <div class="card-header"><h4>MYTV编译配置</h4></div>
                    <div class="card-body">
                        <form method="post" id="appform" enctype="multipart/form-data">
                            <div class="input-group"> 
                                <label>APK连接地址:</label>&nbsp;&nbsp;<button class="btn btn-label btn-danger" type="button" id="lockBtn" onclick="toggleLock(this)"
                                    style=" display:inline-flex; align-items:center; justify-content:center; padding:4px 8px;">
                                    <i class="mdi mdi-lock" style="margin:0; padding:0; vertical-align:middle;"></i>
                                </button>
                                <div class="input-group">
                                    <div><input class="form-control" type="text" id="serverUrl" name="serverUrl" value="{{ .ServerUrl }}" style="margin-top: 15px;" placeholder="APK连接地址"  readonly></div>
                                    <small class="help-block">提示：修改APK连接地址请先点解锁，自动填充当前后台地址，若内网访问，请手动填写外网地址。</small>
                                </div>
                            </div>
                            
                            <div class="form-inline" style="margin-top: 15px;">
                                <div class="form-group" style="margin-right: 15px;">
                                    <label>应用名:</label>
                                    <input class="form-control" type="text" name="app_appname" value="{{ .MyTV.Name }}" placeholder="应用名" >
                                </div>
                                <div class="form-group" style="margin-right: 15px;">
                                    
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <label>应用图标:</label>
                                        <!-- 上传按钮 -->
                                        <label class="btn btn-primary" style="margin:0;">
                                            更改图标
                                            <input type="file" name="iconfile" accept="image/png" onchange="uploadIcon(event)" id="iconInput" style="display:none;">
                                        </label>

                                        <!-- 预览图 -->
                                        <div id="iconContainer" style="position:relative; {{if eq .IconUrl ""}}display:none;{{end}}">
                                            <img id="iconImg" src="{{if .IconUrl }}{{.IconUrl}}{{end}}" alt="预览" style="height:38px; border:1px solid #ccc; border-radius:4px; cursor:pointer;">
                                            <!-- 删除按钮 -->
                                            <span id="deleteIconView" onclick="deleteIcon()" style="
                                                position:absolute; top:-8px; right:-8px;
                                                background:#f00; color:#fff; border-radius:50%;
                                                font-size:14px; line-height:16px; width:16px; height:16px;
                                                text-align:center; cursor:pointer;">×</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-inline" style="margin-top: 15px;">
                                <div class="form-group" style="margin-right: 15px;">
                                    <label>当前版本:1.2.0.</label>
                                    <input class="form-control" type="text" readonly value="{{ .MyTV.Version }}"/>
                                </div>
                                <div class="form-group" style="margin-right: 15px;">
                                    <label>新版本: 1.2.0.</label>
                                    <input class="form-control" type="number" id="app_version" name="app_version" value="{{ .MyTV.Version }}" placeholder="版本号" min="0" max="999" step="1">
                                </div>
                                <div class="form-group">
                                    <label>软件大小:</label>
                                    <input class="form-control" type="text" id="apksize" readonly value="{{ .UpSize }}"/>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 10px;">
                                <label class="btn-block">更新内容:</label>
                                <textarea class="form-control" rows="5" name="up_body" placeholder="请输入更新内容" >{{ .MyTV.Update }}</textarea>
                            </div>
                            <div class="form-inline" style="margin-top: 10px;">
                                <div class="form-group" style="margin-right: 15px;">
                                    <button class="btn btn-label btn-primary" type="button" onclick="BuildMyTVApk(this)" id="buildMyTV" name="buildMyTV" {{if eq .BuildStatus 1}}disabled{{end}}><label><i class="mdi mdi-checkbox-marked-circle-outline"></i></label>编译APK</button>
                                </div>
                                <div class="form-group" >
                                    <a href="{{ .ApkUrl }}" download="{{ .MyTV.Name }}">
                                        <button class="btn btn-label btn-primary download-link" type="button"
                                                {{if eq .BuildStatus 1}}disabled{{end}}>
                                            <label><i class="mdi mdi-download"></i></label>下载客户端
                                        </button>
                                    </a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
		</div>
	</div>
</main>

{{ template "admin_footer" . }}